<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>ç¥–å…ˆè¶…åº¦å ±åè¡¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: sans-serif; padding: 1em; background: #f5f5f5; }
    h1, h2 { text-align: center; margin-bottom: 1em; }
    .entry-card {
      background: white; padding: 1em; border-radius: 12px; margin-bottom: 1em;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .form-group { margin-bottom: 0.7em; }
    label { font-weight: bold; display: block; margin-bottom: 0.3em; }
    input, select {
      width: 100%; padding: 0.5em; font-size: 1em;
      border-radius: 6px; border: 1px solid #ccc;
    }
    button {
      padding: 0.6em 1.2em; font-size: 1em;
      border: none; border-radius: 6px;
      background: #007bff; color: white;
      margin: 0.4em;
    }
    button:hover { background: #0056b3; }
    .delete-btn { background: #dc3545; }
    .delete-btn:hover { background: #a71d2a; }
    .amount { text-align: right; font-weight: bold; margin-top: 0.5em; }
  </style>
</head>
<body>

<h1>ç¥–å…ˆè¶…åº¦å ±åè¡¨</h1>
<h2>åœ°è—æ³•æœƒå°ˆç”¨</h2>

<div id="formContainer"></div>

<div id="amountDisplay" class="amount"></div>

<div style="text-align:center;">
  <button onclick="addEntry()">â• æ–°å¢ä¸€ä½ç¥–å…ˆ</button>
  <button onclick="preview()">ğŸ“‹ é è¦½è³‡æ–™</button>
</div>

<script>
let entries = [];

function calculateAmount(entry) {
  const prices = { token5: 5, boat: 30, lotus: 6, paper3: 3, paper6: 6, paper27: 27 };
  let total = 0;
  for (let key in prices) {
    total += (parseInt(entry[key]) || 0) * prices[key];
  }
  return total;
}

function saveInputs(index) {
  const card = document.querySelectorAll('.entry-card')[index];
  const inputs = card.querySelectorAll('input, select');
  const map = {
    'ç¥–å…ˆ/äº¡éˆå§“å': 'name',
    'å®‰å¥‰åœ°é» / ç·¨è™Ÿ': 'location',
    'TOKEN5': 'token5',
    'BOAT': 'boat',
    'LOTUS': 'lotus',
    'PAPER3': 'paper3',
    'PAPER6': 'paper6',
    'PAPER27': 'paper27'
  };
  inputs.forEach(input => {
    const label = input.previousElementSibling?.innerText.trim();
    const key = map[label] || (label === 'å®‰å¥‰é¡å‹' ? 'type' : '');
    if (key) entries[index][key] = input.value;
  });
}

function saveAllInputs() {
  entries.forEach((_, index) => saveInputs(index));
}

function renderForm() {
  const container = document.getElementById('formContainer');
  container.innerHTML = '';
  let total = 0;

  entries.forEach((entry, index) => {
    const div = document.createElement('div');
    div.className = 'entry-card';

    div.innerHTML = `
      <div class="form-group">
        <label>ç¥–å…ˆ/äº¡éˆå§“å</label>
        <input type="text" value="${entry.name || ''}" oninput="entries[${index}].name = this.value">
      </div>
      <div class="form-group">
        <label>å®‰å¥‰é¡å‹</label>
        <select onchange="entries[${index}].type = this.value; renderForm()">
          <option value="">è«‹é¸æ“‡</option>
          <option value="åœ°è—æ®¿ç‰Œä½" ${entry.type === 'åœ°è—æ®¿ç‰Œä½' ? 'selected' : ''}>åœ°è—æ®¿ç‰Œä½</option>
          <option value="éˆéª¨æ®¿ç¦ä½" ${entry.type === 'éˆéª¨æ®¿ç¦ä½' ? 'selected' : ''}>éˆéª¨æ®¿ç¦ä½</option>
          <option value="å¢“åœ’" ${entry.type === 'å¢“åœ’' ? 'selected' : ''}>å¢“åœ’</option>
          <option value="ç‰Œä½" ${entry.type === 'ç‰Œä½' ? 'selected' : ''}>ç‰Œä½</option>
        </select>
      </div>
      ${entry.type ? `
      <div class="form-group">
        <label>å®‰å¥‰åœ°é» / ç·¨è™Ÿ</label>
        <input type="text" value="${entry.location || ''}" oninput="entries[${index}].location = this.value">
      </div>` : ''}
      ${['token5', 'boat', 'lotus', 'paper3', 'paper6', 'paper27'].map(key => `
        <div class="form-group">
          <label>${key.toUpperCase()}</label>
          <input type="number" min="0" value="${entry[key] || ''}" oninput="entries[${index}]['${key}'] = this.value">
        </div>
      `).join('')}
      <div class="amount">æ­¤ä½é‡‘é¡ï¼š${calculateAmount(entry)} å…ƒ</div>
      ${index > 0 ? `<button class="delete-btn" onclick="deleteEntry(${index})">åˆªé™¤</button>` : ''}
    `;

    container.appendChild(div);
    total += calculateAmount(entry);
  });

  const amountDiv = document.getElementById('amountDisplay');
  amountDiv.textContent = entries.length > 1 ? `ç›®å‰ç¸½é‡‘é¡ï¼š${total} å…ƒ` : '';
}

function addEntry() {
  saveAllInputs();
  if (entries.length >= 8) return alert('æœ€å¤šå¡«å¯« 8 ä½ç¥–å…ˆ');
  entries.push({});
  renderForm();
}

function deleteEntry(index) {
  saveAllInputs();
  entries.splice(index, 1);
  renderForm();
}

function preview() {
  saveAllInputs();
  alert(JSON.stringify(entries, null, 2));
}

// âœ… åˆå§‹åŒ–ç¬¬ä¸€ç­†
entries.push({});
renderForm();
</script>

</body>
</html>
